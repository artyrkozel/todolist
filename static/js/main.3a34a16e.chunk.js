(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{101:function(e,t,a){e.exports=a(131)},106:function(e,t,a){},107:function(e,t,a){},131:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),i=a.n(o);a(106),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(107);var l,c,s=a(172),d=a(173),u=a(174),f=a(166),m=a(169),p=a(176),b=a(177),g=a(175),v=a(14),h=a(28),k=a(83),E=a.n(k).a.create(Object(h.a)({baseURL:"https://social-network.samuraijs.com/api/1.1/"},{withCredentials:!0,headers:{"API-KEY":"c7bbacee-9383-4bb5-9da6-5eaa531e6320"}})),C=function(){return E.get("todo-lists")},j=function(e){return E.post("todo-lists",{title:e})},O=function(e){return E.delete("todo-lists/".concat(e))},y=function(e,t){return E.put("todo-lists/".concat(e),{title:t})},T=function(e){return E.get("todo-lists/".concat(e,"/tasks"))},I=function(e,t){return E.delete("todo-lists/".concat(e,"/tasks/").concat(t))},w=function(e,t){return E.post("todo-lists/".concat(e,"/tasks"),{title:t})},A=function(e,t,a){return E.put("todo-lists/".concat(e,"/tasks/").concat(t),a)},x=function(e){return E.post("auth/login",e)},S=function(){return E.delete("auth/login")},L=function(){return E.get("auth/me")};!function(e){e[e.New=0]="New",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed",e[e.Draft=3]="Draft"}(l||(l={})),function(e){e[e.Low=0]="Low",e[e.Middle=1]="Middle",e[e.Hi=2]="Hi",e[e.Urgently=3]="Urgently",e[e.Later=4]="Later"}(c||(c={}));var F=a(27),P=a.n(F),z=a(40),D=function(e,t){e.messages.length?t(J({error:e.messages[0]})):t(J({error:"Some error occurred"})),t(K({status:"failed"}))},N=function(e,t){t(J({error:e.message?e.message:"Some error occurred"})),t(K({status:"failed"}))},M=a(22),R=Object(M.b)("auth/login",function(){var e=Object(z.a)(P.a.mark((function e(t,a){var n,r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.dispatch(K({status:"loading"})),e.prev=1,e.next=4,x(t);case 4:if(0!==(n=e.sent).data.resultCode){e.next=10;break}return a.dispatch(K({status:"succeeded"})),e.abrupt("return",{isLoggedIn:!0});case 10:return D(n.data,a.dispatch),e.abrupt("return",a.rejectWithValue({errors:n.data.messages,fieldsErrors:n.data.fieldsErrors}));case 12:e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(1),r=e.t0,N(r,a.dispatch),e.abrupt("return",a.rejectWithValue({errors:[r.message],fieldsErrors:void 0}));case 19:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,a){return e.apply(this,arguments)}}()),W=Object(M.c)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedInAC:function(e,t){e.isLoggedIn=t.payload.value}},extraReducers:function(e){e.addCase(R.fulfilled,(function(e,t){t.payload&&(e.isLoggedIn=t.payload.isLoggedIn)}))}}),q=W.reducer,B=W.actions.setIsLoggedInAC,H=Object(M.c)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setAppStatusAC:function(e,t){e.status=t.payload.status},setAppErrorAC:function(e,t){e.error=t.payload.error},setAppInitializedAC:function(e,t){e.isInitialized=t.payload.isInitialized}}}),U=H.reducer,V=H.actions,J=V.setAppErrorAC,K=V.setAppStatusAC,Y=V.setAppInitializedAC,$=Object(M.c)({name:"todolists",initialState:[],reducers:{removeTodolistAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));a>-1&&e.splice(a,1)},addTodolistAC:function(e,t){e.unshift(Object(h.a)(Object(h.a)({},t.payload.todolist),{},{filter:"all",entityStatus:"idle"}))},changeTodolistTitleAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));e[a].title=t.payload.title},changeTodolistFilterAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));e[a].filter=t.payload.filter},changeTodolistEntityStatusAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));e[a].entityStatus=t.payload.status},setTodolistsAC:function(e,t){return t.payload.todolists.map((function(e){return Object(h.a)(Object(h.a)({},e),{},{filter:"all",entityStatus:"idle"})}))}}}),_=$.reducer,G=$.actions,Q=G.removeTodolistAC,X=G.addTodolistAC,Z=G.changeTodolistTitleAC,ee=G.changeTodolistFilterAC,te=G.changeTodolistEntityStatusAC,ae=G.setTodolistsAC,ne=Object(M.b)("tasks/fetchTasks",function(){var e=Object(z.a)(P.a.mark((function e(t,a){var n,r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.dispatch(K({status:"loading"})),e.next=3,T(t);case 3:return n=e.sent,r=n.data.items,a.dispatch(K({status:"succeeded"})),e.abrupt("return",{tasks:r,todolistId:t});case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),re=Object(M.b)("tasks/removeTask",function(){var e=Object(z.a)(P.a.mark((function e(t,a){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t.todolistId,t.taskId);case 2:return e.sent,e.abrupt("return",{taskId:t.taskId,todolistId:t.todolistId});case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),oe=Object(M.c)({name:"tasks",initialState:{},reducers:{addTaskAC:function(e,t){e[t.payload.task.todoListId].unshift(t.payload.task)},updateTaskAC:function(e,t){var a=e[t.payload.todolistId],n=a.findIndex((function(e){return e.id===t.payload.taskId}));n>-1&&(a[n]=Object(h.a)(Object(h.a)({},a[n]),t.payload.model))}},extraReducers:function(e){e.addCase(X,(function(e,t){e[t.payload.todolist.id]=[]})),e.addCase(Q,(function(e,t){delete e[t.payload.id]})),e.addCase(ae,(function(e,t){t.payload.todolists.forEach((function(t){e[t.id]=[]}))})),e.addCase(ne.fulfilled,(function(e,t){e[t.payload.todolistId]=t.payload.tasks})),e.addCase(re.fulfilled,(function(e,t){var a=e[t.payload.todolistId],n=a.findIndex((function(e){return e.id===t.payload.taskId}));n>-1&&a.splice(n,1)}))}}),ie=oe.reducer,le=oe.actions,ce=le.addTaskAC,se=le.updateTaskAC,de=function(e,t,a){return function(n,r){var o=r().tasks[a].find((function(t){return t.id===e}));if(o){var i=Object(h.a)({deadline:o.deadline,description:o.description,priority:o.priority,startDate:o.startDate,title:o.title,status:o.status},t);A(a,e,i).then((function(r){if(0===r.data.resultCode){var o=se({taskId:e,model:t,todolistId:a});n(o)}else D(r.data,n)})).catch((function(e){N(e,n)}))}else console.warn("task not found in the state")}},ue=a(170),fe=a(132),me=a(47),pe=a(178),be=a(167),ge=r.a.memo((function(e){var t=e.addItem,a=e.disabled,o=void 0!==a&&a,i=Object(n.useState)(""),l=Object(me.a)(i,2),c=l[0],s=l[1],d=Object(n.useState)(null),u=Object(me.a)(d,2),m=u[0],p=u[1],b=function(){""!==c.trim()?(t(c),s("")):p("Title is required")};return r.a.createElement("div",null,r.a.createElement(pe.a,{variant:"outlined",disabled:o,error:!!m,value:c,onChange:function(e){s(e.currentTarget.value)},onKeyPress:function(e){null!==m&&p(null),13===e.charCode&&b()},label:"Title",helperText:m}),r.a.createElement(f.a,{color:"primary",onClick:b,disabled:o},r.a.createElement(be.a,null)))})),ve=a(61),he=r.a.memo((function(e){var t=Object(n.useState)(!1),a=Object(me.a)(t,2),o=a[0],i=a[1],l=Object(n.useState)(e.value),c=Object(me.a)(l,2),s=c[0],d=c[1];return o?r.a.createElement(pe.a,{value:s,onChange:function(e){d(e.currentTarget.value)},autoFocus:!0,onBlur:function(){i(!1),e.onChange(s)}}):r.a.createElement("span",{onDoubleClick:function(){i(!0),d(e.value)}},e.value)})),ke=a(168),Ee=a(180),Ce=r.a.memo((function(e){var t=e.task,a=e.todolistId,o=e.removeTask,i=e.changeTaskStatus,c=e.changeTaskTitle,s=(Object(ve.a)(e,["task","todolistId","removeTask","changeTaskStatus","changeTaskTitle"]),Object(n.useCallback)((function(){return o(t.id,a)}),[o,t.id,a])),d=Object(n.useCallback)((function(e){var n=e.currentTarget.checked;i(t.id,n?l.Completed:l.New,a)}),[i,t.id,a]),u=Object(n.useCallback)((function(e){c(t.id,e,a)}),[c,t.id,a]);return r.a.createElement("div",{key:t.id,className:t.status===l.Completed?"is-done":""},r.a.createElement(Ee.a,{checked:t.status===l.Completed,color:"primary",onChange:d}),r.a.createElement(he,{value:t.title,onChange:u}),r.a.createElement(f.a,{onClick:s},r.a.createElement(ke.a,null)))})),je=r.a.memo((function(e){var t=e.demo,a=void 0!==t&&t,o=Object(ve.a)(e,["demo"]),i=Object(v.b)();Object(n.useEffect)((function(){if(!a){var e=ne(o.todolist.id);i(e)}}),[a,o.todolist.id,i]);var c=Object(n.useCallback)((function(e){o.addTask(e,o.todolist.id)}),[o.addTask,o.todolist.id]),s=Object(n.useCallback)((function(){o.removeTodolist(o.todolist.id)}),[o.removeTodolist]),d=Object(n.useCallback)((function(e){o.changeTodolistTitle(o.todolist.id,e)}),[o.todolist.id,o.changeTodolistTitle]),u=Object(n.useCallback)((function(){return o.changeFilter("all",o.todolist.id)}),[o.todolist.id,o.changeFilter]),p=Object(n.useCallback)((function(){return o.changeFilter("active",o.todolist.id)}),[o.todolist.id,o.changeFilter]),b=Object(n.useCallback)((function(){return o.changeFilter("completed",o.todolist.id)}),[o.todolist.id,o.changeFilter]),g=o.tasks;return"active"===o.todolist.filter&&(g=o.tasks.filter((function(e){return e.status===l.New}))),"completed"===o.todolist.filter&&(g=o.tasks.filter((function(e){return e.status===l.Completed}))),r.a.createElement("div",null,r.a.createElement("h3",null,r.a.createElement(he,{value:o.todolist.title,onChange:d}),r.a.createElement(f.a,{onClick:s,disabled:"loading"===o.todolist.entityStatus},r.a.createElement(ke.a,null))),r.a.createElement(ge,{addItem:c,disabled:"loading"===o.todolist.entityStatus}),r.a.createElement("div",null,g.map((function(e){return r.a.createElement(Ce,{key:e.id,task:e,todolistId:o.todolist.id,removeTask:o.removeTask,changeTaskTitle:o.changeTaskTitle,changeTaskStatus:o.changeTaskStatus})}))),r.a.createElement("div",{style:{paddingTop:"10px"}},r.a.createElement(m.a,{variant:"all"===o.todolist.filter?"outlined":"text",onClick:u,color:"default"},"All"),r.a.createElement(m.a,{variant:"active"===o.todolist.filter?"outlined":"text",onClick:p,color:"primary"},"Active"),r.a.createElement(m.a,{variant:"completed"===o.todolist.filter?"outlined":"text",onClick:b,color:"secondary"},"Completed")))})),Oe=a(13),ye=function(e){var t=e.demo,a=void 0!==t&&t,o=Object(v.c)((function(e){return e.todolists})),i=Object(v.c)((function(e){return e.tasks})),l=Object(v.c)((function(e){return e.auth.isLoggedIn})),c=Object(v.b)();Object(n.useEffect)((function(){if(!a&&l){var e=function(e){e(K({status:"loading"})),C().then((function(t){e(ae({todolists:t.data})),e(K({status:"succeeded"}))})).catch((function(t){N(t,e)}))};c(e)}}),[l,a,c]);var s=Object(n.useCallback)((function(e,t){var a=re({taskId:e,todolistId:t});c(a)}),[c]),d=Object(n.useCallback)((function(e,t){var a=function(e,t){return function(a){a(K({status:"loading"})),w(t,e).then((function(e){if(0===e.data.resultCode){var t=e.data.data.item,n=ce({task:t});a(n),a(K({status:"succeeded"}))}else D(e.data,a)})).catch((function(e){N(e,a)}))}}(e,t);c(a)}),[c]),u=Object(n.useCallback)((function(e,t,a){var n=de(e,{status:t},a);c(n)}),[c]),f=Object(n.useCallback)((function(e,t,a){var n=de(e,{title:t},a);c(n)}),[c]),m=Object(n.useCallback)((function(e,t){var a=ee({id:t,filter:e});c(a)}),[c]),p=Object(n.useCallback)((function(e){var t,a=(t=e,function(e){e(K({status:"loading"})),e(te({id:t,status:"loading"})),O(t).then((function(a){e(Q({id:t})),e(K({status:"succeeded"}))}))});c(a)}),[c]),b=Object(n.useCallback)((function(e,t){var a=function(e,t){return function(a){y(e,t).then((function(n){a(Z({id:e,title:t}))}))}}(e,t);c(a)}),[c]),g=Object(n.useCallback)((function(e){var t=function(e){return function(t){t(K({status:"loading"})),j(e).then((function(e){t(X({todolist:e.data.data.item})),t(K({status:"succeeded"}))}))}}(e);c(t)}),[c]);return l?r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.a,{container:!0,style:{padding:"20px"}},r.a.createElement(ge,{addItem:g})),r.a.createElement(ue.a,{container:!0,spacing:3},o.map((function(e){var t=i[e.id];return r.a.createElement(ue.a,{item:!0,key:e.id},r.a.createElement(fe.a,{style:{padding:"10px"}},r.a.createElement(je,{todolist:e,tasks:t,removeTask:s,changeFilter:m,addTask:d,changeTaskStatus:u,removeTodolist:p,changeTaskTitle:f,changeTodolistTitle:b,demo:a})))})))):r.a.createElement(Oe.a,{to:"/login"})},Te=a(182),Ie=a(179);function we(e){return r.a.createElement(Ie.a,Object.assign({elevation:6,variant:"filled"},e))}function Ae(){var e=Object(v.c)((function(e){return e.app.error})),t=Object(v.b)(),a=function(e,a){"clickaway"!==a&&t(J({error:null}))},n=null!==e;return r.a.createElement(Te.a,{open:n,autoHideDuration:6e3,onClose:a},r.a.createElement(we,{onClose:a,severity:"error"},e))}var xe=a(183),Se=a(165),Le=a(171),Fe=a(184),Pe=a(89),ze=a(21),De=a(50),Ne=Object(ze.c)({tasks:ie,todolists:_,app:U,auth:q}),Me=Object(M.a)({reducer:Ne,middleware:function(e){return e().prepend(De.a)}});window.store=Me;var Re=function(){var e=Object(v.b)(),t=Object(v.c)((function(e){return e.auth.isLoggedIn})),a=Object(Pe.a)({validate:function(e){return e.email?e.password?void 0:{password:"Password is required"}:{email:"Email is required"}},initialValues:{email:"",password:"",rememberMe:!1},onSubmit:function(){var t=Object(z.a)(P.a.mark((function t(a,n){var r,o,i,l,c;return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(R(a));case 2:r=t.sent,R.rejected.match(r)&&(null===(o=r.payload)||void 0===o||null===(i=o.fieldsErrors)||void 0===i?void 0:i.length)&&(c=null===(l=r.payload)||void 0===l?void 0:l.fieldsErrors[0],n.setFieldError(c.field,c.error));case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()});return t?r.a.createElement(Oe.a,{to:"/"}):r.a.createElement(ue.a,{container:!0,justify:"center",style:{marginTop:"30px"}},r.a.createElement(ue.a,{item:!0,xs:4},r.a.createElement("form",{onSubmit:a.handleSubmit},r.a.createElement(xe.a,null,r.a.createElement(Se.a,{style:{textAlign:"center"}},r.a.createElement("p",null,"To log in get registered ",r.a.createElement("a",{href:"https://social-network.samuraijs.com/",target:"_blank",rel:"noopener noreferrer"},"here")),r.a.createElement("p",null,"or use common test account credentials:"),r.a.createElement("div",null,r.a.createElement("b",null," Email: free@samuraijs.com")),r.a.createElement("div",null,r.a.createElement("b",null,"Password: free"))),r.a.createElement(Le.a,null,r.a.createElement(pe.a,Object.assign({label:"Email",margin:"normal"},a.getFieldProps("email"))),a.errors.email?r.a.createElement("div",null,a.errors.email):null,r.a.createElement(pe.a,Object.assign({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),a.errors.password?r.a.createElement("div",null,a.errors.password):null,r.a.createElement(Fe.a,{label:"Remember me",control:r.a.createElement(Ee.a,Object.assign({},a.getFieldProps("rememberMe"),{checked:a.values.rememberMe}))}),r.a.createElement(m.a,{type:"submit",variant:"contained",color:"primary"},"Login"))))))};var We=function(e){var t=e.demo,a=void 0!==t&&t,o=Object(v.c)((function(e){return e.app.status})),i=Object(v.c)((function(e){return e.app.isInitialized})),l=Object(v.c)((function(e){return e.auth.isLoggedIn})),c=Object(v.b)();Object(n.useEffect)((function(){a||c((function(e){L().then((function(t){0===t.data.resultCode&&e(B({value:!0})),e(Y({isInitialized:!0}))}))}))}),[c,a]);var h=Object(n.useCallback)((function(){c((function(e){e(K({status:"loading"})),S().then((function(t){0===t.data.resultCode?(e(B({value:!1})),e(K({status:"succeeded"}))):D(t.data,e)})).catch((function(t){N(t,e)}))}))}),[c]);return i?r.a.createElement("div",{className:"App"},r.a.createElement(Ae,null),r.a.createElement(d.a,{position:"static"},r.a.createElement(u.a,null,r.a.createElement(f.a,{edge:"start",color:"inherit","aria-label":"menu"},r.a.createElement(g.a,null)),l&&r.a.createElement(m.a,{color:"inherit",onClick:h},"Log out")),"loading"===o&&r.a.createElement(p.a,null)),r.a.createElement(b.a,{fixed:!0},r.a.createElement(Oe.b,{exact:!0,path:"/",render:function(){return r.a.createElement(ye,{demo:a})}}),r.a.createElement(Oe.b,{path:"/login",render:function(){return r.a.createElement(Re,null)}}))):r.a.createElement("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"}},r.a.createElement(s.a,null))},qe=a(49);i.a.render(r.a.createElement(v.a,{store:Me},r.a.createElement(qe.a,{basename:"/todolist"},r.a.createElement(We,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[101,1,2]]]);
//# sourceMappingURL=main.3a34a16e.chunk.js.map